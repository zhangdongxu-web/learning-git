(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/appraisalProductReport/appraisalProductReport"],{"0c3f":function(t,e,i){"use strict";(function(t){i("5605"),i("921b");s(i("66fd"));var e=s(i("0ddf"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},"0ddf":function(t,e,i){"use strict";i.r(e);var s=i("a300"),a=i("ec8f");for(var l in a)"default"!==l&&function(t){i.d(e,t,function(){return a[t]})}(l);i("59b1");var n=i("2877"),o=Object(n["a"])(a["default"],s["a"],s["b"],!1,null,"49e80e12",null);e["default"]=o.exports},"59b1":function(t,e,i){"use strict";var s=i("814b"),a=i.n(s);a.a},"814b":function(t,e,i){},a300:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c},a=[];i.d(e,"a",function(){return s}),i.d(e,"b",function(){return a})},d8cc:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("a34a"));function a(t){return t&&t.__esModule?t:{default:t}}function l(t,e,i,s,a,l,n){try{var o=t[l](n),r=o.value}catch(h){return void i(h)}o.done?e(r):Promise.resolve(r).then(s,a)}function n(t){return function(){var e=this,i=arguments;return new Promise(function(s,a){var n=t.apply(e,i);function o(t){l(n,s,a,o,r,"next",t)}function r(t){l(n,s,a,o,r,"throw",t)}o(void 0)})}}var o=getApp().globalData.img_src,r={data:function(){return{err:"",canvasImg:"",canvasImg2:"",cwidth:1380,cheight:6e3,data:{title:"实物鉴定评估报告",classItem:"香奈儿",productItem:"精细鉴定",certificate:"第12346号",imgSmall:"http://m.qpic.cn/psb?/V10oV2Rw42RpLG/LRJqUkq93XyQ0tak0VB9jrf2t32oAj1MaSLo*e6ekYo!/b/dL4AAAAAAAAA&bo=yADIAAAAAAARFyA!&rf=viewer_4",mark:7,position:["LOGO压印","五金刻字","序号压印","五金","布标","拉链"],desc:["用户提供图片质量几乎在所有部位未达到清晰度要求/或缺少相应图片","所示图片与品牌标准品相应部位较吻合"]},desc:["本机构作为第三方机构，不参与买卖纠纷","本机构不提供鉴定点相关细节描述","由于照片存在局限性，如对鉴定结果有异议，请于7日内提出申请，进行实物鉴定复审。"],company:"最终结论以实物鉴定为准",addressIcon:o+"/assets/bpimg/canvas_address.png",logoIcon:o+"/assets/bpimg/canvas_baopu.png",checkIcon:o+"/assets/bpimg/canvas_checked.png",addressIcon_gray:o+"/assets/bpimg/canvas_address_gray.png",logoIcon_gray:o+"/assets/bpimg/canvas_baopu_gray.png",checkIcon_gray:o+"/assets/bpimg/canvas_checked_gray.png",initHeight:0,dataDesc:{info:{noid:"0",mode:"",name:""},list:[]}}},onLoad:function(t){this.id=t.id,this.type=t.type},onShow:function(){1==this.type?(this.getDataPhotos(),t.setNavigationBarTitle({title:"鉴定物详情"})):t.setNavigationBarTitle({title:"鉴定报告"})},mounted:function(){this.getData()},methods:{getDataPhotos:function(){var t=this,e={id:this.id};this.$requestApi.goodsinfo(e).then(function(e){t.dataDesc=e.data})},getData:function(){var t=this,e={id:this.id};this.$requestApi.onlineOver(e).then(function(e){var i=e.data;t.data={title:"实物鉴定评估报告",classItem:i.brand,productItem:i.mode,certificate:i.cate,imgSmall:i.image,mark:i.score,position:i.show,desc:i.describe},console.log(t.data),1==i.isture?t.createReport():t.grayReport()})},savePhoto:function(){t.saveImageToPhotosAlbum({filePath:this.canvasImg,success:function(e){t.showToast({title:"下载成功",duration:2e3}),console.log("save success",e)},fail:function(e){"saveImageToPhotosAlbum:fail:auth denied"!==e.errMsg&&"saveImageToPhotosAlbum:fail auth deny"!==e.errMsg||t.showModal({title:"提示",content:"需要您授权保存相册",showCancel:!1,success:function(e){t.openSetting({success:function(e){e.authSetting["scope.writePhotosAlbum"]?t.showModal({title:"提示",content:"获取权限成功,再次点击图片即可保存",showCancel:!1}):t.showModal({title:"提示",content:"获取权限失败，将无法保存到相册哦~",showCancel:!1})}})}})}})},drawImg:function(e){var i=new Promise(function(i,s){t.getImageInfo({src:e,success:i,fail:i})});return i},drawText:function(t,e,i,s,a,l){var n=this.cwidth-360,o=0;t.font="400 36px 微软雅黑",t.fillStyle=l||"#BE9F62";for(var r=0,h=0,c=0;c<e.length;c++)o+=t.measureText(e[c]).width,o>n&&(t.fillText(e.substring(r,c),a,i),i+=72,o=0,r=c,72,h++),c==e.length-1&&t.fillText(e.substring(r,c+1),a,i);this.initHeight+=72*(h+1)},roundRect:function(t,e,i,s,a,l){var n=Math.min(s,a);return l>n/2&&(l=n/2),t.beginPath(),t.moveTo(e+l,i),t.arcTo(e+s,i,e+s,i+a,l),t.arcTo(e+s,i+a,e,i+a,l),t.arcTo(e,i+a,e,i,l),t.arcTo(e,i,e+s,i,l),t.closePath(),t},grayReport:function(){var e=n(s.default.mark(function e(){var i,a,l,n,o,r,h,c,d,f,g,u,v,m,p,x,w,T=this;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading({title:"加载中",mask:!0}),i=t.createCanvasContext("firstCanvas"),console.log(i),i.rect(0,0,this.cwidth,this.cheight),i.setFillStyle("#FFFFFF"),i.fill(),a=170,i.save(),i.font="400 44px 微软雅黑",i.fillStyle="#999999",i.textAlign="center",i.textBaseline="middle",i.fillText("鉴定结果基于用户提供信息得出",460+(this.cwidth-460)/2,2*a),i.restore(),a+=44,i.save(),i.font="bold 64px 微软雅黑",i.fillStyle="#30313B",i.textAlign="center",i.textBaseline="middle",i.fillText("您的商品经在线初审结论为",460+(this.cwidth-460)/2,2*a),i.restore(),a+=64,i.save(),i.font="bold 108px 微软雅黑",i.fillStyle="#C1C1C1",i.textAlign="center",i.textBaseline="middle",i.fillText("伪品",460+(this.cwidth-460)/2,2*a),i.restore(),e.next=32,this.drawImg(this.data.imgSmall);case 32:for(l=e.sent,a+=67,i.save(),i.beginPath(),this.roundRect(i,220,2*a,320,320,20),i.clip(),i.drawImage(l.path,220,2*a,320,320),i.restore(),i.save(),a+=30,i.font="bold 44px 微软雅黑",i.fillStyle="#333333",i.textBaseline="middle",i.fillText("品       牌：",560,2*a),i.fillText("鉴定方式：",560,2*a+104),i.fillText("证书编号：",560,2*a+208),i.fillStyle="#C1C1C1",i.fillText(this.data.classItem,800,2*a),i.fillText(this.data.productItem,800,2*a+104),i.fillText(this.data.certificate,800,2*a+208),i.restore(),a+=208,i.save(),i.font="400 40px 微软雅黑",i.fillStyle="#636365",i.textAlign="center",i.textBaseline="middle",i.fillText("真伪系数值",this.cwidth/2,2*a),i.fillStyle="#636365",i.fillText("仿品",220,2*a),i.fillText("正品",1140,2*a),i.lineWidth=2,i.setLineDash([5,10]),i.strokeStyle="#C1C1C1",i.beginPath(),i.moveTo(320,2*a),i.lineTo(540,2*a),i.closePath(),i.stroke(),i.beginPath(),i.moveTo(840,2*a),i.lineTo(1060,2*a),i.closePath(),i.stroke(),i.restore(),a+=40,i.save(),this.roundRect(i,220,2*a,920,28,28),n=i.createLinearGradient(220,2*a,1140,2*a),n.addColorStop(0,"rgba(53,54,59, 0.2)"),n.addColorStop(1,"rgba(53,54,59, 1)"),i.fillStyle=n,i.fill(),i.restore(),i.save(),i.lineWidth=2,i.strokeStyle="#FFFFFF",o=1;o<10;o++)i.beginPath(),i.moveTo(220+46*o*2,2*a),i.lineTo(220+46*o*2,2*a+28),i.closePath(),i.stroke();return i.restore(),e.next=93,this.drawImg(this.addressIcon_gray);case 93:for(r=e.sent,i.drawImage(r.path,220+46*this.data.mark*2-20,2*a-16,38,52),a+=36,i.save(),i.font="400 36px 微软雅黑",i.fillStyle="#999A9B",i.textAlign="center",i.textBaseline="middle",h=0;h<=10;h++)i.fillText(h,220+46*h*2,2*a);return i.restore(),a+=36,e.next=106,this.drawImg(this.checkIcon_gray);case 106:for(c=e.sent,d=c.path,i.save(),i.font="400 44px 微软雅黑",i.fillStyle="#666666",i.textAlign="left",i.textBaseline="top",f=0,g=0;g<this.data.position.length;g++)u=parseInt(g/3),v=Math.floor(g%3),f=u,i.drawImage(d,180+340*v,2*a+80*u,44,44),i.fillText(this.data.position[g],240+340*v,2*a+80*u);for(i.restore(),a=2*a+80*(f+1)+160,m=0,i.save(),i.font="400 36px 微软雅黑",i.fillStyle="#f2f2f2",this.drawText(i,this.data.desc,a+this.initHeight,80,240,"#ffffff"),m=this.initHeight,i.restore(),i.save(),i.fillStyle="#F2F2F2",this.roundRect(i,this.cwidth/2-550,a-100,1100,m+120,20),i.fill(),i.restore(),i.save(),this.initHeight=0,i.font="400 36px 微软雅黑",i.fillStyle="#666666",this.drawText(i,this.data.desc,a+this.initHeight,80,200,"#666666"),i.restore(),a=a+this.initHeight+180,i.save(),i.fillStyle="#F2F2F2",this.roundRect(i,this.cwidth/2-550,a-80,1100,340,20),i.fill(),i.restore(),i.save(),this.initHeight=0,p=0;p<this.desc.length;p++)this.drawText(i,this.desc[p],a+this.initHeight,80,200,"#666666");return i.restore(),a+=this.initHeight+60,i.save(),i.font="bold 36px 微软雅黑",i.fillStyle="#333333",i.textAlign="center",i.textBaseline="middle",i.fillText(this.company,this.cwidth/2,a),i.restore(),this.cheight=a+100,i.strokeStyle="#999A9B",i.save(),x=4,i.lineWidth=4,i.strokeRect(x,x,this.cwidth-2*x,this.cheight-2*x),i.restore(),i.strokeStyle="#F2F2F2",i.save(),i.lineWidth=4,i.beginPath(),i.moveTo(0,1380),i.quadraticCurveTo(120,120,1080,0),i.lineTo(0,0),i.setFillStyle("#F2F2F2"),i.closePath(),i.stroke(),i.fill(),i.restore(),i.save(),i.lineWidth=4,i.beginPath(),i.moveTo(0,1240),i.quadraticCurveTo(130,130,960,0),i.lineTo(0,0),i.setFillStyle("#30313B"),i.closePath(),i.stroke(),i.fill(),i.restore(),i.save(),i.lineWidth=4,i.beginPath(),i.moveTo(this.cwidth,this.cheight-600),i.quadraticCurveTo(this.cwidth-120,this.cheight-120,this.cwidth-720,this.cheight),i.lineTo(this.cwidth,this.cheight),i.setFillStyle("#F2F2F2"),i.closePath(),i.stroke(),i.fill(),i.restore(),i.save(),i.lineWidth=4,i.beginPath(),i.moveTo(this.cwidth,this.cheight-520),i.quadraticCurveTo(this.cwidth-90,this.cheight-90,this.cwidth-640,this.cheight),i.lineTo(this.cwidth,this.cheight),i.setFillStyle("#30313B"),i.closePath(),i.stroke(),i.fill(),i.restore(),e.next=207,this.drawImg(this.logoIcon_gray);case 207:w=e.sent,i.drawImage(w.path,132,240,268,344),i.draw(!0,function(){setTimeout(function(){t.canvasToTempFilePath({x:0,y:0,canvasId:"firstCanvas",fileType:"jpg",quality:1,width:2*T.cwidth,height:2*T.cheight,destWidth:T.cwidth,destHeight:T.cheight,success:function(e){T.canvasImg=e.tempFilePath,t.hideLoading()},fail:function(e){t.hideLoading(),t.showToast({icon:"none",title:"生成失败,请重试"}),T.err=JSON.stringify(e),console.log(e)}})},2)});case 210:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}(),createReport:function(){var e=n(s.default.mark(function e(){var i,a,l,n,o,r,h,c,d,f,g,u,v,m,p,x,w,T=this;return s.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading({title:"加载中",mask:!0}),i=t.createCanvasContext("firstCanvas"),console.log(i),i.rect(0,0,this.cwidth,this.cheight),i.setFillStyle("#FFFFFF"),i.fill(),a=170,i.save(),i.font="400 44px 微软雅黑",i.fillStyle="#999999",i.textAlign="center",i.textBaseline="middle",i.fillText("鉴定结果基于用户提供信息得出",460+(this.cwidth-460)/2,2*a),i.restore(),a+=44,i.save(),i.font="bold 64px 微软雅黑",i.fillStyle="#30313B",i.textAlign="center",i.textBaseline="middle",i.fillText("您的商品经在线初审结论为",460+(this.cwidth-460)/2,2*a),i.restore(),a+=64,i.save(),i.font="bold 108px 微软雅黑",i.fillStyle="#BE9F62",i.textAlign="center",i.textBaseline="middle",i.fillText("正品",460+(this.cwidth-460)/2,2*a),i.restore(),e.next=32,this.drawImg(this.data.imgSmall);case 32:for(l=e.sent,a+=67,i.save(),i.beginPath(),this.roundRect(i,220,2*a,320,320,20),i.clip(),i.drawImage(l.path,20,300,1e3,1e3,220,2*a,320,320),i.restore(),i.save(),a+=30,i.font="bold 44px 微软雅黑",i.fillStyle="#333333",i.textBaseline="middle",i.fillText("品       牌：",560,2*a),i.fillText("鉴定方式：",560,2*a+104),i.fillText("证书编号：",560,2*a+208),i.fillStyle="#BE9F62",i.fillText(this.data.classItem,800,2*a),i.fillText(this.data.productItem,800,2*a+104),i.fillText(this.data.certificate,800,2*a+208),i.restore(),a+=208,i.save(),i.font="400 40px 微软雅黑",i.fillStyle="#C1C1C1",i.textAlign="center",i.textBaseline="middle",i.fillText("真伪系数值",this.cwidth/2,2*a),i.fillStyle="#BE9F62",i.fillText("仿品",220,2*a),i.fillText("正品",1140,2*a),i.lineWidth=2,i.setLineDash([5,10]),i.strokeStyle="#C1C1C1",i.beginPath(),i.moveTo(320,2*a),i.lineTo(540,2*a),i.closePath(),i.stroke(),i.beginPath(),i.moveTo(840,2*a),i.lineTo(1060,2*a),i.closePath(),i.stroke(),i.restore(),a+=40,i.save(),this.roundRect(i,220,2*a,920,28,28),n=i.createLinearGradient(220,2*a,1140,2*a),n.addColorStop(0,"rgba(190, 159, 98, 0.2)"),n.addColorStop(1,"rgba(190, 159, 98, 1)"),i.fillStyle=n,i.fill(),i.restore(),i.save(),i.lineWidth=2,i.strokeStyle="#FFFFFF",o=1;o<10;o++)i.beginPath(),i.moveTo(220+46*o*2,2*a),i.lineTo(220+46*o*2,2*a+28),i.closePath(),i.stroke();return i.restore(),e.next=93,this.drawImg(this.addressIcon);case 93:for(r=e.sent,i.drawImage(r.path,220+46*this.data.mark*2-20,2*a-16,38,52),a+=36,i.save(),i.font="400 36px 微软雅黑",i.fillStyle="#BE9F62",i.textAlign="center",i.textBaseline="middle",h=0;h<=10;h++)i.fillText(h,220+46*h*2,2*a);return i.restore(),a+=36,e.next=106,this.drawImg(this.checkIcon);case 106:for(c=e.sent,d=c.path,i.save(),i.font="400 44px 微软雅黑",i.fillStyle="#BE9F62",i.textAlign="left",i.textBaseline="top",f=0,g=0;g<this.data.position.length;g++)u=parseInt(g/3),v=Math.floor(g%3),f=u,i.drawImage(d,180+340*v,2*a+80*u,44,44),i.fillText(this.data.position[g],240+340*v,2*a+80*u);for(i.restore(),a=2*a+80*(f+1)+160,m=0,i.save(),i.font="400 36px 微软雅黑",i.fillStyle="#FFFFFF",this.drawText(i,this.data.desc,a+this.initHeight,80,240,"#ffffff"),m=this.initHeight,i.restore(),i.save(),i.fillStyle="#F8F4EE",this.roundRect(i,this.cwidth/2-550,a-100,1100,m+120,20),i.fill(),i.restore(),i.save(),this.initHeight=0,i.font="400 36px 微软雅黑",i.fillStyle="#BE9F62",this.drawText(i,this.data.desc,a+this.initHeight,80,200,""),i.restore(),a=a+this.initHeight+180,i.save(),i.fillStyle="#F2F2F2",this.roundRect(i,this.cwidth/2-550,a-80,1100,400,20),i.fill(),i.restore(),i.save(),this.initHeight=0,p=0;p<this.desc.length;p++)this.drawText(i,this.desc[p],a+this.initHeight,80,200,"#666666");return i.restore(),a+=this.initHeight+60,i.save(),i.font="bold 36px 微软雅黑",i.fillStyle="#333333",i.textAlign="center",i.textBaseline="middle",i.fillText(this.company,this.cwidth/2,a),i.restore(),this.cheight=a+100,i.strokeStyle="#DFC084",i.save(),x=4,i.lineWidth=4,i.strokeRect(x,x,this.cwidth-2*x,this.cheight-2*x),i.restore(),i.save(),i.lineWidth=4,i.beginPath(),i.moveTo(0,1380),i.quadraticCurveTo(120,120,1080,0),i.lineTo(0,0),i.setFillStyle("#DFC084"),i.closePath(),i.stroke(),i.fill(),i.restore(),i.save(),i.lineWidth=4,i.beginPath(),i.moveTo(0,1240),i.quadraticCurveTo(130,130,960,0),i.lineTo(0,0),i.setFillStyle("#30313B"),i.closePath(),i.stroke(),i.fill(),i.restore(),i.save(),i.lineWidth=4,i.beginPath(),i.moveTo(this.cwidth,this.cheight-600),i.quadraticCurveTo(this.cwidth-120,this.cheight-120,this.cwidth-720,this.cheight),i.lineTo(this.cwidth,this.cheight),i.setFillStyle("#DFC084"),i.closePath(),i.stroke(),i.fill(),i.restore(),i.save(),i.lineWidth=4,i.beginPath(),i.moveTo(this.cwidth,this.cheight-520),i.quadraticCurveTo(this.cwidth-90,this.cheight-90,this.cwidth-640,this.cheight),i.lineTo(this.cwidth,this.cheight),i.setFillStyle("#30313B"),i.closePath(),i.stroke(),i.fill(),i.restore(),e.next=206,this.drawImg(this.logoIcon);case 206:w=e.sent,i.drawImage(w.path,132,240,268,344),i.draw(!0,function(){setTimeout(function(){t.canvasToTempFilePath({x:0,y:0,canvasId:"firstCanvas",fileType:"jpg",quality:1,width:2*T.cwidth,height:2*T.cheight,destWidth:T.cwidth,destHeight:T.cheight,success:function(e){T.canvasImg=e.tempFilePath,t.hideLoading();var i=T;wx.uploadFile({url:i.$upLoadUrl,filePath:i.canvasImg,name:"file",header:{"content-type":"multipart/form-data"},formData:{pathname:"lisence"},success:function(t){var e=JSON.parse(t.data);console.log(e.data,"898989")},fail:function(t){console.log(t)}}),console.log(T.canvasImg,"this.canvasImg")},fail:function(e){t.hideLoading(),t.showToast({icon:"none",title:"生成失败,请重试"}),T.err=JSON.stringify(e),console.log(e)}})},200)});case 209:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}()}};e.default=r}).call(this,i("543d")["default"])},ec8f:function(t,e,i){"use strict";i.r(e);var s=i("d8cc"),a=i.n(s);for(var l in s)"default"!==l&&function(t){i.d(e,t,function(){return s[t]})}(l);e["default"]=a.a}},[["0c3f","common/runtime","common/vendor"]]]);