(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/IdentRoom/IdentRoom","components/uni-popup/uni-popup"],{"483b":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(o("a34a"));n(o("4996")),n(o("2571")),o("058c");function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e,o,i,n,a,s){try{var c=t[a](s),r=c.value}catch(u){return void o(u)}c.done?e(r):Promise.resolve(r).then(i,n)}function s(t){return function(){var e=this,o=arguments;return new Promise(function(i,n){var s=t.apply(e,o);function c(t){a(s,i,n,c,r,"next",t)}function r(t){a(s,i,n,c,r,"throw",t)}c(void 0)})}}var c=t.getRecorderManager(),r=t.createInnerAudioContext(),u={data:function(){return{imgaaa:["../../static/camera_play.png","../../static/camera_play.png","../../static/camera_play.png","../../static/camera_play.png","../../static/camera_play.png"],quanju:!1,id:"",state:"",auth:"",identTab:"",exId:[],jtext:"",orderState:"",choselist:[],datainfo:{},voicePlay:!1,record:!1,start:5,activeStartIndex:null,activeStartText:"",goodsInfo:{},istext:"2",voicePath:"",timer:"",voiceNum:"",voiceLength:"",toBeIdentifiedList:[],toBePersonTeacherList:[],attach:[],appraisalSuccess:1,ident_success_btn_show:0,sort:getApp().globalData.sort,choseImgList:{exp:[],upload:[]}}},onLoad:function(e){var o=this;console.log("option",e),this.id=e.id,this.state=e.type,this.auth=e.auth,this.identTab=e.identTab,this.goodsInfo=t.getStorageSync("userinfo")||"",c.onError(function(t){console.log("#######录音失败############")}),c.onStop(function(e){console.log("录音结束----------------------------",e.tempFilePath),o.voiceNum=Math.round(e.duration/1e3),o.voiceLength=Math.round(e.duration/1e3),t.showLoading({title:"正在上传",mask:!0}),t.uploadFile({url:o.$upLoadUrl,filePath:e.tempFilePath,name:"file",header:{"content-type":"multipart/form-data"},formData:{pathname:"lisence"},success:function(e){if(console.log(e),t.hideLoading(),200==e.statusCode){var i=JSON.parse(e.data);console.log("*****data",i),o.voicePath=i.data,t.hideToast()}else t.showModal({title:"提示",content:"上传失败",showCancel:!1})},fail:function(e){console.log(e),t.hideLoading(),t.hideToast(),t.showModal({title:"提示",content:"上传失败",showCancel:!1})}})}),r.onEnded(function(t){o.voicePlay=!1,o.timer&&(o.voiceNum=o.voiceLength,clearInterval(o.timer)),o.toBePersonTeacherList.forEach(function(t){t.assayer.voicePlay=!1,t.assayer.seconds=t.assayer.len,clearInterval(t.assayer.timer),t.user&&(t.user.voicePlay=!1,t.user.seconds=t.user.len,clearInterval(t.user.timer))})})},onShow:function(){var t=this,e={id:this.id};this.$requestApi.getBeIdentifiedList(e).then(function(e){console.log(e,"获取用户信息"),t.orderState=e.data.orderState}),this.sort=getApp().globalData.sort,this.getBeIdentifiedListHand(),this.getChoseImg()},methods:{userReply:function(e){var o={id:this.id,tid:e.id,talk:{images:"",text:this.jtext,voice:this.voicePath,seconds:this.voiceNum}};0!=this.choselist.length?(o.talk.images=this.choselist.map(function(t){return JSON.stringify(t)}),o.talk=JSON.stringify(o.talk),this.$requestApi.roomtalk(o).then(function(e){1e3==e.code?(t.showToast({icon:"none",title:"回复成功"}),setTimeout(function(){t.navigateBack()},1e3)):t.showToast({icon:"none",title:e.message})})):t.showToast({icon:"none",title:"请选择补拍图片"})},reply:function(){var e={id:this.id,tid:"",talk:{images:"",text:this.jtext,voice:this.voicePath,seconds:this.voiceNum}};0!=this.choselist.length?(e.talk.images=this.choselist.map(function(t){return JSON.stringify(t)}),e.talk=JSON.stringify(e.talk),this.$requestApi.roomtalk(e).then(function(e){1e3==e.code?(t.showToast({icon:"none",title:"回复成功"}),setTimeout(function(){t.navigateBack()},1e3)):t.showToast({icon:"none",title:e.message})})):t.showToast({icon:"none",title:"请选择补拍图片"})},closeBrand:function(){this.$refs.choseimg.close()},AddImgMessage:function(){this.$refs.choseimg.open()},getChoseImg:function(){var t=this,e={id:this.id};this.$requestApi.chooseimg(e).then(function(e){t.choseImgList=e.data})},startActive:function(t){this.activeStartIndex=t},startBtn:function(){var e=s(i.default.mark(function e(){var o,n;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o={id:this.id,star:this.activeStartIndex,memo:this.activeStartText},e.next=3,this.$requestApi.postevaluate(o);case 3:n=e.sent,1e3==n.code&&(this.$refs.popup.close(),t.showToast({icon:"none",title:"评价成功"}),this.ident_success_btn_show=1);case 5:case"end":return e.stop()}},e,this)}));function o(){return e.apply(this,arguments)}return o}(),appraisalProductReport:function(){t.navigateTo({url:"/pages/appraisalProductReport/appraisalProductReport?id="+this.id})},change_text:function(t){this.istext=t,2==t&&(this.voicePath="")},startRecord:function(){console.log("开始录音"),this.record=!0,c.start({duration:6e4,format:"mp3"})},endRecord:function(){this.record=!1,console.log("录音结束"),c.stop()},playVoice:function(t,e,o){var i=this,n=t&&1==t?"user":"assayer";0==t||1==t?(this.toBePersonTeacherList[e][n]["voicePlay"]=!0,this.toBePersonTeacherList[e][n]["len"]=o.seconds,console.log("this.toBePersonTeacherList[index]",this.toBePersonTeacherList[e]),r.src=o.voice,r.play(),this.toBePersonTeacherList[e][n]["timer"]=setInterval(function(){i.toBePersonTeacherList[e][n].seconds>=1&&i.toBePersonTeacherList[e][n].seconds--},1e3)):(this.voicePlay=!0,this.timer&&clearInterval(this.timer),this.voicePath&&(r.src=this.voicePath,r.play(),this.timer=setInterval(function(){i.voiceNum>=1&&i.voiceNum--},1e3)))},openPopup:function(){this.$refs.popup.open()},getBeIdentifiedListHand:function(){var t=s(i.default.mark(function t(){var e,o;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={id:this.id},t.next=3,this.$requestApi.getBeIdentifiedList(e);case 3:o=t.sent,1e3==o.code&&(this.datainfo=o.data.info,this.toBeIdentifiedList=o.data.list,this.attach=o.data.attach,console.log("11111111111",this.attach),o.data.exchange.forEach(function(t){t.assayer.images.forEach(function(e,o){t.assayer.images[o]=JSON.parse(e),t.assayer.len=t.assayer.seconds}),t.user&&t.user.images.forEach(function(e,o){t.user.images[o]=JSON.parse(e),t.user.len=t.user.seconds})}),console.log("sort",this.sort),0==this.sort?(this.toBePersonTeacherList=0==o.data.exchange.length?[{assayer:"",user:null}]:o.data.exchange,console.log(this.toBePersonTeacherList),this.toBePersonTeacherList[this.toBePersonTeacherList.length-1].user&&this.toBePersonTeacherList.push({assayer:"",user:null}),console.log("toBePersonTeacherList",this.toBePersonTeacherList)):this.toBePersonTeacherList=o.data.exchange);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),closePopup:function(){this.$refs.popup.close()},userAddImgMessage:function(e){var o=this;console.log(e,"indexindex"),t.showActionSheet({itemList:["拍照","相册"],success:function(i){var n=i.tapIndex,a=["camera","album"];a=[a[n]],o.$uploadPhoto(a,function(i){console.log(o.toBePersonTeacherList[e].assayer.images.length),o.choselist.length>=o.toBePersonTeacherList[e].assayer.images.length?setTimeout(function(){t.showToast({icon:"none",title:"不得超过鉴定师补拍数量"})},200):o.choselist.push({image:i.data})})},fail:function(t){console.log(t.errMsg)}})},appraiserAddImgMessage:function(e){var o=this;t.showActionSheet({itemList:["拍照","相册"],success:function(t){var i=t.tapIndex,n=["camera","album"];n=[n[i]],o.$uploadPhoto(n,function(t){console.log(t,"aaaaaaaaaaaaaa"),o.choselist.push({image:t.data}),o.imgaaa.splice(e,1,o.choselist[o.choselist.length-1].image)})},fail:function(t){console.log(t.errMsg)}})},goScore:function(){console.log(this),console.log(this.id+"&&type="+this.state+"&&auth="+this.auth+"&&identTab="+this.identTab),t.navigateTo({url:"../onlineAppraisalDetail/onlineAppraisalDetail?id="+this.id+"&type=3&auth=1&identTab="+this.identTab})}},computed:{ismode:function(){var t=this.goodsInfo.mode;return 1==t?"标准鉴定":2==t?"精细鉴定":3==t?"专家鉴定":void 0}}};e.default=u}).call(this,o("543d")["default"])},4996:function(t,e,o){"use strict";o.r(e);var i=o("51ed"),n=o("4cfd");for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);o("fa8e");var s=o("2877"),c=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports},"4cfd":function(t,e,o){"use strict";o.r(e);var i=o("f963"),n=o.n(i);for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);e["default"]=n.a},"51ed":function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},n=[];o.d(e,"a",function(){return i}),o.d(e,"b",function(){return n})},aaad:function(t,e,o){"use strict";var i=o("ee61"),n=o.n(i);n.a},bfea:function(t,e,o){"use strict";o.r(e);var i=o("483b"),n=o.n(i);for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);e["default"]=n.a},c7b2:function(t,e,o){},d474:function(t,e,o){"use strict";o.r(e);var i=o("f7af"),n=o("bfea");for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);o("aaad");var s=o("2877"),c=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,"3be33748",null);e["default"]=c.exports},ee61:function(t,e,o){},f7af:function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},n=[];o.d(e,"a",function(){return i}),o.d(e,"b",function(){return n})},f963:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"UniPopup",props:{animation:{type:Boolean,default:!0},type:{type:String,default:"bottom"},custom:{type:Boolean,default:!1},maskClick:{type:Boolean,default:!0},show:{type:Boolean,default:!0}},data:function(){return{ani:"",showPopup:!1}},watch:{show:function(t){t?this.open():this.close()}},created:function(){},methods:{clear:function(){},open:function(){var t=this;this.$emit("change",{show:!0}),this.showPopup=!0,this.$nextTick(function(){setTimeout(function(){t.ani="uni-"+t.type},30)})},close:function(t){var e=this;!this.maskClick&&t||(this.$emit("change",{show:!1}),this.ani="",this.$nextTick(function(){setTimeout(function(){e.showPopup=!1},300)}))}}};e.default=i},fa8e:function(t,e,o){"use strict";var i=o("c7b2"),n=o.n(i);n.a},fffb:function(t,e,o){"use strict";(function(t){o("5605"),o("921b");i(o("66fd"));var e=i(o("d474"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])}},[["fffb","common/runtime","common/vendor"]]]);