(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/onlineappraisal/onlineappraisal"],{"000e":function(t,a,e){},"08f2":function(t,a,e){"use strict";(function(t){e("5605"),e("921b");o(e("66fd"));var a=o(e("9fe0"));function o(t){return t&&t.__esModule?t:{default:t}}t(a.default)}).call(this,e("543d")["createPage"])},1864:function(t,a,e){"use strict";var o=e("000e"),i=e.n(o);i.a},"5cdc":function(t,a,e){"use strict";e.r(a);var o=e("6773"),i=e.n(o);for(var n in o)"default"!==n&&function(t){e.d(a,t,function(){return o[t]})}(n);a["default"]=i.a},6773:function(t,a,e){"use strict";(function(t){function e(t){return n(t)||i(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function n(t){if(Array.isArray(t)){for(var a=0,e=new Array(t.length);a<t.length;a++)e[a]=t[a];return e}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r={data:function(){return{radio_02:!1,classShow:!0,payFlag:!0,payMasker:{state:0,title:"",price:"0",integral:"0"},defaultData:{state:0,count:"",txt:"亲爱的王二小\n今天想鉴定什么物品呢？",isshow:!1,id:0,classList:[]},historyData:[],data:[],productList:[],appraisalMode:[],style:{pageHeight:0,contentViewHeight:0,footViewHeight:90,mitemHeight:0},genre:"",brand:"",level:"",money:""}},onLoad:function(){var a=this;this.$requestApi.getClassList().then(function(e){var o=t.getStorageSync("userinfo");a.defaultData.txt="亲爱的"+o.nickname+"\n今天想鉴定什么物品呢？",a.defaultData.classList=e.data.list;var i=JSON.parse(JSON.stringify(a.defaultData));a.data.push(i);var n=JSON.parse(JSON.stringify(a.defaultData));a.historyData.push(n),a.getAppraisalMode()})},methods:{radioClick:function(){this.radio_02=!this.radio_02},goprotocol:function(){t.navigateTo({url:"../protocol/protocol"})},goAppraisalRoom:function(){t.navigateTo({url:"../purchase/purchase?id="+this.orderid})},paySure:function(a){var e=this;if(this.radio_02)if(a)t.getProvider({service:"payment",success:function(a){~a.provider.indexOf("wxpay")&&(console.log("微信支付"),t.login({provider:"wxpay",success:function(a){a.code&&(console.log(a.code),e.$requestApi.wxpay({code:a.code,money:.01}).then(function(a){console.log(a,"888"),e.orderid=a.data.orderid,t.requestPayment({provider:"wxpay",timeStamp:a.data.timeStamp,nonceStr:a.data.nonceStr,package:a.data.package,signType:a.data.signType,paySign:a.data.paySign,success:function(a){t.showToast({icon:"none",title:"支付成功",position:"bottom"}),e.$refs.popupAppraisal.close(),e.$requestApi.beforeorder({genre:e.genre,brand:e.brand,level:e.level,orderid:e.orderid,paytype:"wxpay"}).then(function(t){e.orderid=t.data.id;var a={state:1,appraisalTxt:e.payMasker.title},o={state:0,upLoadImg:"请填写鉴定品信息："};e.data[e.data.length-1].appraisalMode=[],console.log(e.data,e.data.length),e.payFlag=!1,e.data.push(a),e.scrollToBottom(),setTimeout(function(){e.data.push(o),e.scrollToBottom()},600)})},fail:function(a){t.showToast({icon:"none",title:"支付失败",position:"bottom"})}})}))}}))}});else console.log("积分支付"),this.$requestApi.scorepay({score:this.payMasker.integral}).then(function(a){1e3==a.code?(e.orderid=a.data.orderid,t.showToast({icon:"none",title:"支付成功",position:"bottom"}),e.$refs.popupAppraisal.close(),e.$requestApi.beforeorder({genre:e.genre,brand:e.brand,level:e.level,orderid:e.orderid,score:e.payMasker.integral,paytype:"score"}).then(function(t){e.orderid=t.data.id;var a={state:1,appraisalTxt:e.payMasker.title},o={state:0,upLoadImg:"请填写鉴定品信息："};e.data[e.data.length-1].appraisalMode=[],console.log(e.data,e.data.length),e.payFlag=!1,e.data.push(a),e.scrollToBottom(),setTimeout(function(){e.data.push(o),e.scrollToBottom()},600)})):t.showToast({icon:"none",title:a.message})});else t.showToast({icon:"none",title:"请您阅读并同意服务协议",duration:1500})},scrollToBottom:function(){t.createSelectorQuery().select(".bubble-countw").boundingClientRect(function(a){t.pageScrollTo({duration:600,scrollTop:a.bottom})}).exec()},choseAppraisalMode:function(t,a){this.level=parseInt(a)+1,this.money=t.price,this.payMasker={state:a,title:t.name,price:t.price,integral:10*t.price},this.$refs.popupAppraisal.open()},getAppraisalMode:function(){var t=this;this.$requestApi.getAppraisalMode().then(function(a){t.appraisalMode=a.data.list})},clickBrand:function(t){var a=this;this.brand=t.id,this.data[this.data.length-1].choseBrand=0,this.closeBrand();var o=JSON.parse(JSON.stringify(t));o["state"]=1,o["brand"]=1,this.data.push(o);var i={state:0,appraisal:1,appraisalMode:this.appraisalMode};setTimeout(function(){a.data.push(i)},600),setTimeout(function(){a.scrollToBottom()},1600),this.historyData=[].concat(e(this.historyData),[o,i])},getProductList:function(){var t=this;this.$requestApi.getProductList({genre:this.id}).then(function(a){t.productList=a.data.list})},choseBrand:function(){this.$refs.popupBrand.open(),this.getProductList()},closeBrand:function(){this.$refs.popupBrand.close()},revoke:function(){var t=this.data.map(function(t){return t.state});t=t.reduce(function(t,a){return t[a]?t[a]++:t[a]=1,t},{});var a=t[1];if(a>=2){this.historyData=this.historyData.splice(0,this.historyData.length-2);var o=JSON.parse(JSON.stringify(this.historyData));this.data=e(o)}else{o=JSON.parse(JSON.stringify(this.defaultData));this.data=[o]}},choseClass:function(t){var a=this;this.genre=t.id;var o={state:1,count:"",txt:"我要鉴定"+t.name,isshow:!0,image:t.image},i={state:0,txt:"好的！是什么品牌的"+t.name+"呢？",choseBrand:1};this.data[0].classList=[],this.data.push(o),this.id=t.id,setTimeout(function(){a.data.push(i);var t=JSON.parse(JSON.stringify(a.data));a.historyData=e(t)},600)}}};a.default=r}).call(this,e("543d")["default"])},"9fe0":function(t,a,e){"use strict";e.r(a);var o=e("cf2d"),i=e("5cdc");for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);e("1864");var r=e("2877"),s=Object(r["a"])(i["default"],o["a"],o["b"],!1,null,"a1c7e712",null);a["default"]=s.exports},cf2d:function(t,a,e){"use strict";var o=function(){var t=this,a=t.$createElement;t._self._c},i=[];e.d(a,"a",function(){return o}),e.d(a,"b",function(){return i})}},[["08f2","common/runtime","common/vendor"]]]);