(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/appraisalReport/appraisalReport"],{"0acf":function(t,e,a){"use strict";var i=a("b3a8"),s=a.n(i);s.a},"1df1":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(a("a34a"));function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e,a,i,s,n,o){try{var r=t[n](o),c=r.value}catch(h){return void a(h)}r.done?e(c):Promise.resolve(c).then(i,s)}function o(t){return function(){var e=this,a=arguments;return new Promise(function(i,s){var o=t.apply(e,a);function r(t){n(o,i,s,r,c,"next",t)}function c(t){n(o,i,s,r,c,"throw",t)}r(void 0)})}}var r={data:function(){return{err:"",canvasImg:"",cwidth:1380,cheight:1960,data:{}}},onLoad:function(t){this.id=t.id},mounted:function(){this.getData()},methods:{getData:function(){var t=this,e={id:this.id};this.$requestApi.goodsOver(e).then(function(e){t.data={title:"实物鉴定评估报告",stitle:"PHYSICAL APPRAISAL REPORT",classItem:e.data.brand,certificate:e.data.cate,basis:[e.data.basis],result:e.data.result,imgList:e.data.image,person:"张先生",company:"北京包铺鉴定有限公司",desc:["1、实物鉴定结论不可作为司法用途","2、本电子证书对该商品负责，一旦该商品的电子吊牌，防伪贴纸，挂绳任意一件损坏，此证书立即失效","3、若对鉴定结果有异议，需要在5日内提出，逾期不予受理"]},console.log(e.data),t.createReport()})},savePhoto:function(){t.saveImageToPhotosAlbum({filePath:this.canvasImg,success:function(e){t.showToast({title:"下载成功",duration:2e3}),console.log("save success",e)},fail:function(e){"saveImageToPhotosAlbum:fail:auth denied"!==e.errMsg&&"saveImageToPhotosAlbum:fail auth deny"!==e.errMsg||t.showModal({title:"提示",content:"需要您授权保存相册",showCancel:!1,success:function(e){t.openSetting({success:function(e){e.authSetting["scope.writePhotosAlbum"]?t.showModal({title:"提示",content:"获取权限成功,再次点击图片即可保存",showCancel:!1}):t.showModal({title:"提示",content:"获取权限失败，将无法保存到相册哦~",showCancel:!1})}})}})}})},drawImg:function(){var e=o(i.default.mark(function e(a){var s;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s=new Promise(function(e,i){t.getImageInfo({src:a,success:e,fail:e})}),e.abrupt("return",s);case 2:case"end":return e.stop()}},e,this)}));function a(t){return e.apply(this,arguments)}return a}(),drawText:function(t,e,a,i,s,n){var o=this.cwidth-280,r=0;t.font=n||"400 40px 微软雅黑",t.fillStyle="#35363B";for(var c=0,h=0;h<e.length;h++)r+=t.measureText(e[h]).width,r>o&&(t.fillText(e.substring(c,h),s,a),a+=80,r=0,c=h,80),h==e.length-1&&t.fillText(e.substring(c,h+1),s,a)},canvas_text:function(t,e,a,i,s){t.font=a,t.fillStyle=i,t.textAlign="center",t.textBaseline="middle",t.fillText(e,this.cwidth/2,s)},createReport:function(){var e=o(i.default.mark(function e(){var a,s,n,o,r,c,h,d,l,u,f,g,v,p,m,w=this;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading({title:"加载中",mask:!0}),a=t.createCanvasContext("firstCanvas"),a.rect(0,0,this.cwidth,this.cheight),a.setFillStyle("#FFFFFF"),a.fill(),a.strokeStyle="#C1C1C1",a.save(),a.lineWidth=8,a.strokeRect(8,8,this.cwidth-16,this.cheight-16),a.restore(),a.save(),a.lineWidth=2,a.setLineDash([5,5]),a.strokeRect(32,32,this.cwidth-64,this.cheight-64),a.restore(),a.save(),a.lineWidth=6,a.moveTo(30,30),a.lineTo(80,30),a.stroke(),a.moveTo(30,28),a.lineTo(30,80),a.stroke(),a.moveTo(this.cwidth-80,30),a.lineTo(this.cwidth-30,30),a.stroke(),a.moveTo(this.cwidth-30,28),a.lineTo(this.cwidth-30,80),a.stroke(),a.moveTo(30,this.cheight-80),a.lineTo(30,this.cheight-30),a.stroke(),a.moveTo(30,this.cheight-30),a.lineTo(80,this.cheight-30),a.stroke(),a.moveTo(this.cwidth-30,this.cheight-80),a.lineTo(this.cwidth-30,this.cheight-30),a.stroke(),a.moveTo(this.cwidth-80,this.cheight-30),a.lineTo(this.cwidth-30,this.cheight-30),a.stroke(),a.restore(),a.save(),this.canvas_text(a,this.data.title,"bold 80px 微软雅黑","#C9AB79",160),a.restore(),e.next=47,this.drawImg(getApp().globalData.img_src+"/assets/bpimg/canvas_l.png");case 47:return s=e.sent,a.drawImage(s.path,220,130,112,30),e.next=51,this.drawImg(getApp().globalData.img_src+"/assets/bpimg/canvas_r.png");case 51:n=e.sent,a.drawImage(n.path,1040,130,112,30),a.save(),this.canvas_text(a,this.data.stitle,"400 32px 微软雅黑","#C9AB79",240),a.restore(),a.save(),o=160,r=(this.cwidth-320*this.data.imgList.length-80)/2,c=0;case 60:if(!(c<this.data.imgList.length)){e.next=69;break}return r=r+320*c+80*c,e.next=64,this.drawImg(this.data.imgList[c]);case 64:h=e.sent,a.drawImage(h.path,r,2*o,320,320);case 66:c++,e.next=60;break;case 69:return o+=200,d="商品品牌："+this.data.classItem,l="商品品类："+this.data.productItem,u="证书编号："+this.data.certificate,f="结       论："+this.data.result,this.drawText(a,d,2*o,80,120),this.drawText(a,l,2*(o+40),80,120),this.drawText(a,u,2*(o+80),80,120),g=420,v=120,o+=80,this.data.basis.map(function(t,e){0==e?t="鉴定依据："+t:v=320,w.drawText(a,t,2*(o+40*(e+1)),80,v)}),this.drawText(a,f,2*o+40*(this.data.basis.length+1)*2,80,120),o=g+40*(this.data.basis.length+1)*2,a.restore(),o+=320,o+=160,a.save(),this.drawText(a,this.data.company,o+160,80,720,"0 40px 微软雅黑","#636365"),a.restore(),p=getApp().globalData.img_src+"/assets/bpimg/yijianding.png",e.next=92,this.drawImg(p);case 92:m=e.sent,a.drawImage(m.path,r+60,o-120,316,314),o+=240,a.save(),this.drawText(a,"备注：",o,80,180,"400 36px 微软雅黑","#666666"),o+=80,a.restore(),a.save(),this.drawText(a,this.data.desc[0],o,80,180,"400 36px 微软雅黑","#666666"),o+=80,this.drawText(a,this.data.desc[1],o,160,180,"400 36px 微软雅黑","#666666"),o+=160,this.drawText(a,this.data.desc[2],o,80,180,"400 36px 微软雅黑","#666666"),a.restore(),console.log(o),a.draw(!1,function(){setTimeout(function(){console.log(1123213),t.canvasToTempFilePath({x:0,y:0,canvasId:"firstCanvas",fileType:"jpg",quality:1,destWidth:w.cwidth/2,destHeight:w.cheight/2,success:function(e){w.canvasImg=e.tempFilePath,t.hideLoading()},fail:function(e){t.hideLoading(),t.showToast({icon:"none",title:"生成失败,请重试"}),w.err=JSON.stringify(e),console.log(e)}})},2e3)});case 108:case"end":return e.stop()}},e,this)}));function a(){return e.apply(this,arguments)}return a}()}};e.default=r}).call(this,a("543d")["default"])},"2ff5":function(t,e,a){"use strict";(function(t){a("5605"),a("921b");i(a("66fd"));var e=i(a("9668"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"343b":function(t,e,a){"use strict";a.r(e);var i=a("1df1"),s=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);e["default"]=s.a},"5a0c":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},s=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return s})},9668:function(t,e,a){"use strict";a.r(e);var i=a("5a0c"),s=a("343b");for(var n in s)"default"!==n&&function(t){a.d(e,t,function(){return s[t]})}(n);a("0acf");var o=a("2877"),r=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,"1be1c549",null);e["default"]=r.exports},b3a8:function(t,e,a){}},[["2ff5","common/runtime","common/vendor"]]]);